# HimCentre Telegram Bot

Telegram бот для HimCentre на базе Telegraf.

## Установка

1. Установите зависимости:
```bash
npm install
```

2. Создайте `.env` файл:
```bash
touch .env
```

3. Получите токен бота:
   - Откройте [@BotFather](https://t.me/BotFather) в Telegram
   - Отправьте команду `/newbot`
   - Следуйте инструкциям
   - Скопируйте полученный токен

4. Заполните `.env` файл всеми необходимыми переменными:
```env
# Telegram Bot Configuration
BOT_TOKEN=ваш_токен_здесь

# SQLite Database (опционально, по умолчанию: ./data/bot.db)
SQLITE_PATH=./data/bot.db
```

## Запуск

### Продакшн режим:
```bash
npm start
```

### Режим разработки (с автоперезагрузкой):
```bash
npm run dev
```

## Настройка приветственного сообщения

### Способ 1: Через BotFather (рекомендуется)

1. Откройте [@BotFather](https://t.me/BotFather)
2. Отправьте `/mybots` и выберите своего бота
3. Нажмите **"Edit Bot"** → **"Edit About"** - для короткого текста (показывается в чате до /start)
4. Нажмите **"Edit Bot"** → **"Edit Description"** - для полного описания (показывается в профиле)

### Способ 2: Программно через бота

После запуска бота отправьте ему команду:
```
/setdesc
```

Это установит описания, которые указаны в коде. Для изменения текста отредактируйте функцию `setBotDescriptions()` в `index.js`.

## Настройка кнопок

**Важно:** Системную кнопку START изменить нельзя, НО есть альтернативы!

**Быстрый выбор:**
- **Хотите избежать кнопки START?** → Используйте постоянную клавиатуру (раскомментируйте в `index.js`)
- **Хотите кнопку меню с вашим текстом?** → Menu Button уже настроена автоматически!
- **Хотите меню под сообщениями?** → Inline Keyboard уже работает по умолчанию!

## Возможности

- ✅ Сбор данных пользователей через диалог
- ✅ Валидация введенных данных
- ✅ Сохранение данных в SQLite базу данных
- ✅ Обработка ошибок и повторная регистрация
- ✅ Понятный пользовательский интерфейс

## Структура данных

Бот собирает следующую информацию от пользователей:
- Имя
- Фамилия
- Номер телефона
- Название компании
- Сфера деятельности

Все данные сохраняются в SQLite базу данных с уникальным идентификатором Telegram пользователя.

## База данных

Бот использует SQLite для хранения данных. Файл базы данных создается автоматически при первом запуске.

**Структура таблицы:**
```sql
CREATE TABLE registrations (
  id INTEGER PRIMARY KEY,
  telegram_id INTEGER UNIQUE NOT NULL,
  firstname TEXT NOT NULL,
  lastname TEXT NOT NULL,
  phone TEXT NOT NULL,
  company TEXT NOT NULL,
  activity_type TEXT NOT NULL,
  created_at TEXT NOT NULL DEFAULT (datetime('now'))
);
```

## Docker

Для запуска в Docker используйте docker-compose:
```bash
docker-compose up -d --build
```

Данные базы сохраняются в именованном volume `bot-data`.

## Дальнейшая разработка

Вы можете расширить функционал:
- Добавить экспорт данных в CSV/Excel
- Интегрировать с внешними API
- Добавить админ-панель для просмотра регистраций
- Настроить уведомления администраторам

